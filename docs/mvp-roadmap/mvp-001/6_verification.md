# MVP-001 クロスプラットフォーム検証計画（ドラフト）

## 対象環境
- **iOS**: iOS 18.x（Xcode 15.4 以降のシミュレーター）および iOS 18 実機（iPhone）。
  - 次期メジャーバージョン（iOS 26 想定）への対応は別 Issue で検討する。
- **Android**: Expo Android エミュレーター（最新 PlayStore イメージ）。実機は未定。

## 検証観点
1. **位置情報許可フロー**
   - 初回起動で許可を求め、許可すると現在地へフォーカスする。
   - 拒否した場合はフォールバック座標を表示し、設定アプリ誘導の UI が出る。
   - 一度拒否後に設定から許可へ変更 → アプリ復帰時に現在地へ戻る。
2. **マップ追従・再フォーカス**
   - 追従モードで位置シミュレーションに合わせて地図が滑らかに移動する。
   - 地図をドラッグすると追従が解除され、右下に再フォーカスボタンが現れる。
   - ボタン押下で最新位置へ戻り、追従が再開する。
3. **天気ウィジェット**
   - 権限許可時に天気アイコン＋気温が表示される。
   - 権限拒否時にロック表示＋設定誘導が出る。
   - 通信失敗時に Wi-Fi オフ表示＋再読み込みボタンが動作する。
   - モーダルを開閉しても位置やレイアウトが崩れない。
4. **ルート描画（ダミーデータ）**
   - ダミーの `RoutePlan` を投入し、スポットマーカーとポリラインが想定どおり描画できる。
   - 複数ルートの切り替えに対応できる `MapRouteOverlayState` の構造が機能する。

## 手順概要
- iOS: `npm run ios` でシミュレーター起動 → Xcode の Location メニューで位置を切替え → 許可の ON/OFF をテスト。
- iOS 実機: Expo Go またはビルド済みアプリをインストールし、実際の移動／設定アプリ操作で挙動を確認。
- Android: `npm run android` でエミュレーター起動 → Android Studio で位置設定を変更 → 拒否/許可フローを確認。
- 天気ウィジェットのネットワーク失敗は一時的に端末のネットワークをオフにする、または API URL を無効値に差し替えて再現。
- ルート描画はモックデータを `MapTop` に注入し、UI の崩れがないか確認。

## 既知の制約
- iOS シミュレーターは歩行レベルの位置追従が精密ではないため、動作確認は位置シミュレーション（"Freeway Drive" など）で代替する。
- Android エミュレーターで Google Play Services が古い場合、位置情報が取得できないことがある。最新イメージを使用する。
- 実機 Android の検証計画は未定。端末手配が決まり次第、記録フォーマットを本ドキュメントに追記。
- Open-Meteo API のレート制限があるため、短時間に多数の再読み込みを行うと失敗する可能性がある。

## 手動テストの頻度・担当
- 現時点では未定。決定し次第、以下を更新する:
  - 実施タイミング（例: スプリント最終日 / リリース前）
  - 担当者ローテーション
  - チェックリストの参照先（`MVP-008` との連携）

## ドキュメント連携
- 本ドキュメントで決めた検証観点は `MVP-008`（検証チェックリスト）に転記し、完了条件に含める。
- 実際の実行ログやスクリーンショットは `docs/mvp-roadmap/mvp-001/verification-log/`（仮）に保存し、README から参照することを検討。

